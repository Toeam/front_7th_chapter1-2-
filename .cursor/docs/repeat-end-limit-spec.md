# 반복 종료 조건(날짜 지정 + 최대 2025-12-31 제한) 명세서

## 📋 개요
- 목적: 반복 일정의 종료 조건을 "특정 날짜까지"로 지정할 수 있게 하고, 예제/과제 특성상 모든 반복 확장에 대해 최대 종료 한계를 2025-12-31로 제한한다.
- 범위: 도메인 유틸(`getFilteredEvents`의 반복 확장), 폼 입력(종료일 선택), 뷰/검색에서의 표시 반영.
- 기대 효과: 무한/장기 반복으로 인한 성능/표시 이슈 방지, 사용자에게 명확한 종료 정책 제공.

## 🎯 요구사항
### 기능 요구사항
- [ ] 사용자는 반복 일정 생성/수정 시 종료 조건으로 "특정 날짜까지"를 설정할 수 있다.
- [ ] 반복 종료일이 설정된 경우, 해당 날짜를 포함하여 표시하고, 그 이후는 표시하지 않는다.
- [ ] 종료일이 설정되지 않았더라도, 시스템은 최대 종료 한계를 2025-12-31로 강제 적용한다.
- [ ] 반복 유형(매일/매주/매월/매년)별 확장 로직은 기존 규칙(31일/윤년 등)을 유지한다.

### 비기능 요구사항
- 성능: 월/주 범위 확장 시 O(N) 수준(이벤트 수 기준) 유지.
- 사용성: 종료일 선택은 선택 사항이며, 미선택 시에도 시스템 최대 종료 한계가 적용됨을 문서/도움말로 안내 가능.
- 접근성: 폼 라벨과 힌트 텍스트 제공.

## 📊 입력값 및 예시
### 입력 (타입은 기존 유지)
```typescript
// src/types.ts
export interface RepeatInfo {
  type: 'none' | 'daily' | 'weekly' | 'monthly' | 'yearly';
  interval: number;      // 기존 유지
  endDate?: string;      // 'YYYY-MM-DD' (해당 날짜 포함)
}
```

### 동작 예시
```typescript
// 예시 1) 매월, 종료일 지정
// 시작일: '2025-01-31', repeat: { type: 'monthly', interval: 1, endDate: '2025-03-31' }
// 기대: 2025-01-31, 2025-03-31 표시. 2월은 31일 부재로 미표시. 4월 이후 미표시.

// 예시 2) 매주, 종료일 미지정(시스템 최대 한계 적용)
// 시작일: '2025-10-01'(수), repeat: { type: 'weekly', interval: 1 }
// 기대: 2025-12-31(수 이후 해당 주 포함)까지만 표시. 2026년 이후 미표시.

// 예시 3) 매년, 윤년 시작(2/29), 종료일 미지정
// 시작일: '2024-02-29', repeat: { type: 'yearly', interval: 1 }
// 기대: 2028-02-29은 시스템 최대 한계(2025-12-31) 초과이므로 미표시.
```

## 🔗 영향받는 부분
- 영향받는 유틸/훅/컴포넌트
  - `src/utils/eventUtils.ts`: 반복 확장 시 종료일 비교 로직에 "시스템 최대 종료일 2025-12-31" 상한 추가 필요.
  - `src/hooks/useEventForm.ts`: 종료일 입력 유지(UI가 있다면 힌트/placeholder 수준 안내 검토).
  - `src/App.tsx`: 종료일 입력 UI가 노출된다면 라벨/힌트 문구 점검.
- 수정이 필요한 파일
  - `src/utils/eventUtils.ts` (필수)
  - `src/App.tsx`, `src/hooks/useEventForm.ts` (UI가 있는 경우 텍스트만 점검)
- 새로운 파일/디렉토리
  - 불필요. (필요 시 상수 `REPEAT_MAX_END_DATE`를 유틸 내부에 선언)

## ✅ 체크리스트
- [ ] 명세 완료(본 문서)
- [ ] 영향 범위 파악 완료
- [ ] 테스트 케이스 설계: 종료일 지정/미지정, 경계일(2025-12-31), 유형별 유지 규칙 포함
- [ ] 개발자 리뷰 완료

## 🧪 테스트해야 할 케이스(요약)
- 종료일 지정 시: 해당 종료일(포함)까지 표시, +1 일자는 미표시
- 종료일 미지정 시: 2025-12-31 이후는 미표시
- 2025-12-31이 반복 주기 상 발생일이면 포함됨
- 매월 31일 규칙 유지, 윤년 2/29 규칙 유지

## 시나리오
1) 사용자가 반복을 "매주"로 설정하고 종료일을 비워둔다 → 주/월 뷰에서 2025-12-31까지 표시, 2026-01 범위에서는 미표시.
2) 사용자가 반복을 "매월"로 설정하고 종료일을 '2025-03-31'로 지정 → 3월 뷰까지 표시되며, 4월 뷰에서는 미표시.
3) 사용자가 2024-02-29을 "매년"으로 설정하고 종료일을 미지정 → 2025년까지는 해당 월에 표시 없음, 2028-02-29도 시스템 한계로 미표시.
