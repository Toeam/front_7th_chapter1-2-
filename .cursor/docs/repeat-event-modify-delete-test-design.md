# 반복 일정 수정/삭제 테스트 설계

## 목표
- 명세서(.cursor/docs/repeat-event-modify-delete-spec.md)의 요구사항을 검증하는 통합/단위 테스트 케이스를 정의한다.

## 범위
- 통합: `__tests__/medium.repeat.integration.spec.tsx`에 시나리오 추가
- 단위: `eventUtils.getFilteredEvents`의 exceptions 스킵 동작 보강 테스트

## 공통 전제
- 우측 목록에서 수정/삭제 아이콘 → 좌측 폼 저장/확인 모달 흐름 사용
- 반복 아이콘 표시 조건: `repeat.type !== 'none'`

## 통합 테스트 케이스
### 1) 반복 일정 단일 수정(예)
- Given: 주간 반복 이벤트 A(수요일), 현재 월/주 뷰에 노출됨
- When: 우측 목록에서 A 수정 → 좌측 폼에서 제목을 'A-수정'으로 변경 → 저장 → 모달에서 '예'
- Then:
  - 해당 날짜에 단일 이벤트 'A-수정'만 표시되고 반복 아이콘은 없음
  - 시리즈의 동일 날짜 인스턴스는 표시되지 않음

### 2) 반복 일정 전체 수정(아니오)
- Given: 주간 반복 이벤트 B(목요일)
- When: 수정 → 제목을 'B-전체수정'으로 변경 → 저장 → 모달에서 '아니오'
- Then:
  - 반복 아이콘 유지
  - 과거/미래 인스턴스 포함 동일 요일 인스턴스에 제목이 반영됨(뷰 범위 내)

### 3) 반복 일정 단일 삭제(예)
- Given: 주간 반복 이벤트 C(금요일)
- When: 삭제 → 모달에서 '예'
- Then:
  - 해당 날짜 인스턴스만 목록/달력에서 사라짐
  - 이후 주의 인스턴스는 계속 표시됨

### 4) 반복 일정 전체 삭제(아니오)
- Given: 주간 반복 이벤트 D(화요일)
- When: 삭제 → 모달에서 '아니오'
- Then:
  - 시리즈 전체가 목록/달력에서 제거됨

### 5) 모달 취소 시 아무 변경 없음
- Given: 반복 이벤트 E
- When: 수정/삭제 진행 중 모달에서 취소
- Then: 상태 변화 없음(토스트 검증 생략 또는 존재 시 메시지 확인)

## 단위 테스트 케이스(eventUtils)
### 6) exceptions에 포함된 날짜는 확장 결과에서 제외된다
- Given: weekly 이벤트(시작: 2025-10-01, 수), exceptions=['2025-10-08']
- When: 2025-10-08이 포함된 주 뷰 필터링
- Then: 2025-10-08 인스턴스는 결과에 없음, 10-01/10-15 인스턴스는 규칙대로 표시

### 7) exceptions 중복은 무시된다(중복 자제)
- Given: 동일 날짜가 exceptions에 여러 번 들어가도 표시되지 않음
- Then: 결과의 안정성 유지(존재하지 않아야 함)

## 비고
- MSW로 생성/수정/삭제 요청을 핸들하고, 서버 응답 후 리스트/달력 반영을 검증
- 접근성 쿼리: 모달 버튼은 `getByRole('button', { name: /예|아니오/ })` 형태를 기대(정확 레이블은 RED 단계에서 고정)
